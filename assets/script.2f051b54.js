const b=async()=>{await WA.onInit(),await WA.players.configureTracking({players:!0,movement:!1});let p=!0,l=!1,i="en",a,t;const m=new Map([["Umair",{month:2,day:1}],["Hugo",{month:2,day:14}],["Anton",{month:2,day:22}],["Darine",{month:3,day:20}],["Ali",{month:5,day:15}],["Antoine",{month:5,day:26}],["Cloe",{month:7,day:16}],["Alex",{month:7,day:22}],["Vincent",{month:8,day:23}],["Vivi",{month:10,day:4}],["Polina",{month:11,day:7}],["Gregance",{month:11,day:6}]]),y=new Date,n=m.get(WA.player.name),r=n&&n.month===y.getMonth()+1&&n.day===y.getDate();r&&WA.room.showLayer("birthday"),WA.room.onEnterLayer("Trigger/Welcome").subscribe(()=>{if(t=!0,p)r?a=WA.ui.openPopup("WelcomePopup",`Happy birthday ${WA.player.name}`,[]):a=WA.ui.openPopup("WelcomePopup","Welcome to Pulsar Systems Office !",[]),p=!1;else{const c=[...[{label:"English",symbol:"en"},{label:"French",symbol:"fr"},{label:"Spanish",symbol:"es"}].filter(e=>e.symbol!==i).map(e=>({label:e.label,className:"primary",callback:d=>{i=e.symbol,d.close()}})),{label:l?"Soft mode":"Trash mode",className:"primary",callback:e=>{l=!l,e.close()}}];fetch(`https://v2.jokeapi.dev/joke/Any?lang=${i}&blacklistFlags=${l?"":"racist,sexist,explicit"}`).then(e=>e.json()).then(e=>{t&&(e.type==="twopart"?(a=WA.ui.openPopup("WelcomePopup",e.setup,[]),setTimeout(()=>{a.close(),t&&(a=WA.ui.openPopup("WelcomePopup",e.delivery,c))},4e3)):a=WA.ui.openPopup("WelcomePopup",e.joke,c))})}}),WA.room.onLeaveLayer("Trigger/Welcome").subscribe(()=>{t=!1,r&&WA.room.hideLayer("birthday"),a.close()});const u=["Gregance"],s=WA.sound.loadSound("music/happy-birthday.mp3");u.includes(WA.player.name)&&(WA.ui.registerMenuCommand("Happy birthday",{callback:()=>{s.play({}),WA.player.state.saveVariable("HappyBirthdaySong",!0,{public:!0,persist:!1,scope:"room"})}}),WA.ui.registerMenuCommand("Happy birthday stop",{callback:()=>{s.stop(),WA.player.state.saveVariable("HappyBirthdaySong",!1,{public:!0,persist:!1,scope:"room"})}})),WA.players.onVariableChange("HappyBirthdaySong").subscribe(o=>{o.value?s.play({}):s.stop()});const h=WA.room.area.create({name:"Jukebox",x:741,y:760,width:436,height:235});WA.players.onVariableChange("Jukebox").subscribe(o=>{console.log("Jukebox change = ",o.value),h.setProperty("playAudio",o.value),o.value||WA.room.hideLayer("disco")})};b().then();
