const b=async()=>{await WA.onInit(),await WA.players.configureTracking({players:!0,movement:!1});let p=!0,r=!1,t="en",o,l;const u=new Map([["Umair",{month:2,day:1}],["Hugo",{month:2,day:14}],["Anton",{month:2,day:22}],["Darine",{month:3,day:20}],["Ali",{month:5,day:15}],["Antoine",{month:5,day:26}],["Cloe",{month:7,day:16}],["Alex",{month:7,day:22}],["Vincent",{month:8,day:23}],["Vivi",{month:10,day:4}],["Polina",{month:11,day:7}],["Polinka",{month:11,day:7}],["Gregance",{month:12,day:17}]]),c=new Date,i=u.get(WA.player.name),n=i&&i.month===c.getMonth()+1&&i.day===c.getDate();n&&WA.room.showLayer("birthday"),WA.room.onEnterLayer("Trigger/Welcome").subscribe(()=>{if(l=!0,p)n?o=WA.ui.openPopup("WelcomePopup",`Happy birthday ${WA.player.name}`,[]):o=WA.ui.openPopup("WelcomePopup","Welcome to Pulsar Systems Office !",[]),p=!1;else{const m=[...[{label:"English",symbol:"en"},{label:"French",symbol:"fr"},{label:"Spanish",symbol:"es"}].filter(e=>e.symbol!==t).map(e=>({label:e.label,className:"primary",callback:h=>{t=e.symbol,h.close()}})),{label:r?"Soft mode":"Trash mode",className:"primary",callback:e=>{r=!r,e.close()}}];fetch(`https://v2.jokeapi.dev/joke/Any?lang=${t}&blacklistFlags=${r?"":"racist,sexist,explicit"}`).then(e=>e.json()).then(e=>{l&&(e.type==="twopart"?(o=WA.ui.openPopup("WelcomePopup",e.setup,[]),setTimeout(()=>{o.close(),l&&(o=WA.ui.openPopup("WelcomePopup",e.delivery,m))},4e3)):o=WA.ui.openPopup("WelcomePopup",e.joke,m))})}}),WA.room.onLeaveLayer("Trigger/Welcome").subscribe(()=>{l=!1,n&&WA.room.hideLayer("birthday"),o.close()});const d=["Gregance"],s=WA.sound.loadSound("music/happy-birthday.mp3");d.includes(WA.player.name)&&(WA.ui.registerMenuCommand("Happy birthday",{callback:()=>{s.play({}),WA.player.state.saveVariable("HappyBirthdaySong",!0,{public:!0,persist:!1,scope:"room"})}}),WA.ui.registerMenuCommand("Happy birthday stop",{callback:()=>{s.stop(),WA.player.state.saveVariable("HappyBirthdaySong",!1,{public:!0,persist:!1,scope:"room"})}}),WA.ui.registerMenuCommand("Dancer",{callback:()=>{WA.room.showLayer("dancer"),WA.room.showLayer("dancerFloor"),WA.player.state.saveVariable("Dancer",!0,{public:!0,persist:!1,scope:"room"})}}),WA.ui.registerMenuCommand("Dancer Stop",{callback:()=>{WA.room.hideLayer("dancer"),WA.room.hideLayer("dancerFloor"),WA.player.state.saveVariable("Dancer",!1,{public:!0,persist:!1,scope:"room"})}})),WA.players.onVariableChange("HappyBirthdaySong").subscribe(a=>{a.value?s.play({}):s.stop()}),WA.players.onVariableChange("Dancer").subscribe(a=>{a.value?(WA.room.showLayer("dancer"),WA.room.showLayer("dancerFloor")):(WA.room.hideLayer("dancer"),WA.room.hideLayer("dancerFloor"))});const y=WA.room.area.create({name:"Jukebox",x:1146,y:764,width:652,height:235});WA.players.onVariableChange("Jukebox").subscribe(a=>{console.log("Jukebox change = ",a.value),y.setProperty("playAudio",a.value),a.value||WA.room.hideLayer("disco")}),WA.room.area.onLeave("Jukebox").subscribe(()=>{y.setProperty("playAudio",void 0)})};b().then();
